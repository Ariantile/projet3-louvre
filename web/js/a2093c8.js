;$(function(){function me(e,t,a,i){this.dateVisite=e;this.typeBillet=t;this.nbVisiteur=a;this.totalPrix=i};function N(e,t,a,i,l,s,n){this.nomBillet=e;this.prenomBillet=t;this.paysBillet=a;this.naissanceBillet=i;this.idBillet=l;this.nomTarif=s;this.prixTarif=n};function ue(e,t,a,i){this.nomFacturation=e;this.prenomFacturation=t;this.paysFacturation=a;this.naissanceFacturation=i};var x=$('#dateConnexion').text(),m=x.split('/'),y=$.datepicker.parseDate('dd/mm/yy',x),E=parseInt($('#heureConnexion').text()),d,n,a=[],ge=[],s,t=0,D=0,l=0,u,h,b,c,f,v,p,B,g,R=/^[0-3][0-9]\/[0-1][0-9]\/[1-2][901][0-9][0-9]$/,J=/^[a-zA-Z-'éíóúèìòùâêîôûëäïöüãñæçÉÍÓÚÈÌÒÙÂÊÎÔÛËÄÏÖÜÃÑÆÇ]+$/,w=/^[a-z0-9._-]+@[a-z0-9._-]{2,}\.[a-z]{2,10}$/,e=$('#locale').text(),q='Billet n°',V='<p class="messageErreur">Doit comporter entre 2 et 30 caractères alphabétiques.</p>',M='<p class="messageErreur">Veuillez indiquer votre pays de résidence.</p>',A='<p class="messageErreur">Date incorrecte, format : JJ/MM/AAAA</p>',L='<p class="messageErreur">Entrée gratuite pour les moins de 4 ans.</p>',U='<p class="messageErreur">Tarif réduit non applicable.</p>',I='<p class="messageErreur">Adresse courriel invalide, format : adresse@mail.com</p>',Y='<p class="messageErreur">Le champ de confirmation doit être identique au champ courriel.</p>',z='Ticket n°',O='<p class="messageErreur">From 2 to 30 alphabetic characters only.</p>',H='<p class="messageErreur">Please indicate your country of residence.</p>',T='<p class="messageErreur">Invalid date, format : DD/MM/YYYY</p>',S='<p class="messageErreur">Free access for child aged under 4.</p>',j='<p class="messageErreur">Reduced rate not applicable.</p>',Z='<p class="messageErreur">Invalid email addresse, format : addresse@mail.com</p>',ee='<p class="messageErreur">Both email fields must be identical.</p>',te='Enfant de moins de 4 ans : Entrée gratuite',ae='Tarif réduit unique',ie='Tarif enfant, de 4 à 11 ans',le='Tarif normal, de 12 à 59 ans',se='Tarif senior, 60 ans et plus',ne='Date de naissance invalide',oe='Child aged under 4 : Free access',re='Unique reduced rate',de='Child rate, from 4 to 11 years old',ce='Normal rate, from 12 to 59 years old',fe='Senior rate, from 60 years old',pe='Invalid date of birth';function F(e){e.keydown(function(e){if(e.keyCode!==193&&e.keyCode!==111){if(e.keyCode!==8){if($(this).val().length===2){$(this).val($(this).val()+'/')}
else if($(this).val().length===5){$(this).val($(this).val()+'/')}}
else{var t=$(this).val();if($(this).val().length===5){$(this).val(t.substring(0,4))}
else if($(this).val().length===2){$(this).val(t.substring(0,1))}}}
else{var t=$(this).val(),a=$(this).val().length;$(this).val(t.substring(0,a-1))}})};function o(e,t){e.addClass('champVide');if(!e.next().hasClass('messageErreur')){e.parent().append(t)}};function r(e){e.removeClass('champVide');if(e.next().hasClass('messageErreur')){e.next().remove()}};function C(t){var d=$('#panierBillets').find('div').hasClass(t.idBillet);if(d===!0){$('div.'+t.idBillet+' > p.nomPanier').text(t.nomBillet);$('div.'+t.idBillet+' > p.tarifPanier').text(t.nomTarif+' : '+t.prixTarif+'€')}
else{var i=$('<div></div>'),n=$('<p class="nomPanier"></p>'),o=$('<p class="prenomPanier"></p>'),r=$('<p class="tarifPanier"></p>');i.addClass(t.idBillet);n.text(t.nomBillet);o.text(t.prenomBillet);r.text(t.nomTarif+' : '+t.prixTarif+'€');i.append(n);i.append(o);i.append(r);$('#panierBillets').append(i);$('#icoPanier').text(a.length)};l=0;for(var s=0;s<a.length;s++){l+=parseFloat(a[s].prixTarif)};if($('#commande_demiJournee_1').is(':checked')){if(e==='FR'){$('#totalPanier').text('TOTAL (-50% demi-journée) : '+(l/2)+'€')}
else if(e==='EN'){$('#totalPanier').text('TOTAL (50% off for half-day) : '+(l/2)+'€')}}
else{$('#totalPanier').text('TOTAL : '+l+'€')}};function he(e,t,l,s,o,r,d){var c=0;if(a.length===0){var n=new N(e,t,l,s,o,r,d);a.push(n);C(n)}
else{for(var i=0;i<a.length;i++){if(a[i].idBillet===o){c=1;a[i].nomBillet=e;a[i].prenomBillet=t;a[i].paysBillet=l;a[i].naissanceBillet=s;a[i].nomTarif=r;a[i].prixTarif=d;C(a[i])}};if(c===0){var n=new N(e,t,l,s,o,r,d);a.push(n);C(n)}}};function be(e){var t=e.split('/');if((t[2]>m[2])||(t[2]===m[2]&&t[1]>m[1])||(t[2]===m[2]&&t[1]===m[1]&&t[0]>m[0])){p=1}
else if(t[0]>31||t[0]===0){p=1}
else if((t[0]>30)&&(t[1]==='04'||t[1]==='06'||t[1]==='09'||t[1]==='11')){p=1}
else if(t[1]==='02'&&t[0]>28){if(t[0]==='29'&&(t[2]%400===0||(t[2]%100!==0&&t[2]%4===0))){p=0}
else{p=1}}
else{p=0}};function ve(t){var a;if(t.val().length<10||t.val()===''||t.val()===null||!R.test(t.val())){if(e==='FR'){a=A};if(e==='EN'){a=T};o(t,a);c=1}
else{be(t.val());if(p===1){if(e==='FR'){a=A};if(e==='EN'){a=T};o(t,a);c=1}
else if(t.hasClass('champVide')){r(t);c=0}}};function Be(){if($('#commande_billets_'+t+'_tarifReduit').is(':checked')){B=1}
else{B=0;f=0;if($('#commande_billets_'+t+'_tarifReduit').hasClass('champVide')){r($('#commande_billets_'+t+'_tarifReduit'))}}};function k(t,a,i,s){var l,n;if(t.val().length<=1||t.val().length>30||t.val()===''||!J.test(t.val())){if(e==='FR'){l=V};if(e==='EN'){l=O};o(t,l);u=1}
else{if(t.hasClass('champVide')){r(t);u=0}};if(a.val().length<=1||t.val().length>30||a.val()===''){if(e==='FR'){l=V};if(e==='EN'){l=O};o(a,l);h=1}
else{if(a.hasClass('champVide')){r(a);h=0}};if(i.val()===null||i.val()===''){if(e==='FR'){n=M};if(e==='EN'){n=H};o(i,n);b=1}
else{if(i.hasClass('champVide')){r(i);b=0}};ve(s)};function xe(t){var a;if(!w.test(t.val())){if(e==='FR'){a=I};if(e==='EN'){a=Z};o(t,a);v=1}
else{if(t.hasClass('champVide')){r(t);v=0}}};function ye(t,a){var i;if(t.val()!=a.val()){if(e==='FR'){i=Y};if(e==='EN'){i=ee};o(a,i);v=1}
else{if(a.hasClass('champVide')){r(a);v=0}}};function P(a){var s=$('.dateReserv').val().split('/'),n=$(a).val().split('/'),u=s[2]-n[2],i,d,l,c;Be();if(R.test($('.dateReserv').val())){if((n[1]<s[1])||((n[1]===s[1])&&(n[0]<s[0]))){i=u-1}
else if((n[1]>s[1])||((n[1]===s[1])&&(n[0]>s[0]))){i=u}
else if((n[1]===s[1])&&(n[0]===s[0])){i=u}}
else{i=!1};if(i<4){d=0;if(e==='FR'){l=te}
else if(e==='EN'){l=oe}}
else if(B===1&&i>=12){d=10;if(e==='FR'){l=ae}
else if(e==='EN'){l=re};c='reduit';f=0;if($('#commande_billets_'+t+'_tarifReduit').hasClass('champVide')){r($('#commande_billets_'+t+'_tarifReduit'))}}
else if(i>=4&&i<12){d=8;if(e==='FR'){l=ie}
else if(e==='EN'){l=de};c='enfant'}
else if(i>=12&&i<60){d=16;if(e==='FR'){l=le}
else if(e==='EN'){l=ce};c='normal'}
else if(i>=60){d=12;if(e==='FR'){l=se}
else if(e==='EN'){l=fe};c='senior'}
else{d=0;if(e==='FR'){l=ne}
else if(e==='EN'){l=pe};c='invalide'};if(B===1&&i<12){var m;f=1;if(e==='FR'){m=U}
else if(e==='EN'){m=j};o($('#commande_billets_'+t+'_tarifReduit'),m);return!1}
else if(i<4||d===0){var p;f=1;if(e==='FR'){p=L}
else if(e==='EN'){p=S};o($('#commande_billets_'+t+'_naissanceBillet'),p);return!1};he($('#commande_billets_'+t+'_nomBillet').val(),$('#commande_billets_'+t+'_prenomBillet').val(),$('#commande_billets_'+t+'_paysBillet').val(),$('#commande_billets_'+t+'_naissanceBillet').val(),$('#commande_billets_'+t+'_nomBillet').parent().parent().attr('id'),l,d);$('#commande_billets_'+t+'_prixBillet').val(d);$('#commande_billets_'+t+'_tarifBillet').val(c)};$('#addBillet').prop('disabled',!0);$('#supBillet').prop('disabled',!0);$('#subForm').prop('disabled',!0);$('#totalPanier').val(0);$('#commande_demiJournee_0').attr('checked',!1).prop('disabled',!0);$('#commande_demiJournee_1').attr('checked',!1).prop('disabled',!0);$('#next1').prop('disabled',!0);F($('.dateReserv'));F($('.dateFacturation'));$('#tabs').tabs();$('#btPanier').click(function(){if($('#panier').is(':visible')){$('#panier').fadeOut(250)}
else{$('#panier').fadeIn(250)}});$(window).scroll(function(){$('#panier').fadeOut(50)});$('#next0').click(function(){s=0;$('#secuHorraire').hide(1000,function(){$('#bloc_choix').show(800)})});$('#next1').click(function(){if((s===0)&&(D===0)){s=1;t=0;d=new me();d.dateVisite=$('.dateReserv').val();d.typeBillet=$('#typeBillet').text();d.nbVisiteur=$('#commande_qte').val();d.totalPrix=0;g=$('#commande_qte').val();if(g>1){$('#next2').prop('disabled',!0)}
else{$('#next2').prop('disabled',!1)};$('#step1').removeClass('stepActuOn');$('#step1').addClass('stepActuOff');$('#bloc_choix').hide(1000,function(){$('#step2').removeClass('stepActuOff');$('#step2').addClass('stepActuOn');$('#bloc_billet').show(800);$('.blocUnBillet0').show(800);$('#backB').prop('disabled',!0);if(d.nbVisiteur<=1){$('#nextB').prop('disabled',!0)}
else if(d.nbVisiteur>1){$('#nextB').prop('disabled',!1)}})}});$('#next2').click(function(){if(s===1){k($('#commande_billets_'+t+'_nomBillet'),$('#commande_billets_'+t+'_prenomBillet'),$('#commande_billets_'+t+'_paysBillet'),$('#commande_billets_'+t+'_naissanceBillet'));if(u===1||h===1||b===1||c===1){return!1};P($('#commande_billets_'+t+'_naissanceBillet'));if(f===1){return!1};s=2;$('.blocUnBillet'+t).hide(800);$('#step2').removeClass('stepActuOn');$('#step2').addClass('stepActuOff');$('#bloc_billet').hide(1000,function(){$('#step3').removeClass('stepActuOff');$('#step3').addClass('stepActuOn');$('#bloc_facturation').show(800)})}});$('#next3').click(function(){if(s===2){k($('#commande_facturation_nomFacture'),$('#commande_facturation_prenomFacture'),$('#commande_facturation_pays'),$('#commande_facturation_naissanceFacture'));xe($('#commande_facturation_courriel_first'));ye($('#commande_facturation_courriel_first'),$('#commande_facturation_courriel_second'));if(u===1||h===1||b===1||c===1||v===1){return!1};s=3;n=new ue();n.nomFacturation=$('#commande_facturation_nomFacture').val();n.prenomFacturation=$('#commande_facturation_prenomFacture').val();n.paysFacturation=$('#commande_facturation_pays option:selected').text();n.naissanceFacturation=$('#commande_facturation_naissanceFacture').val();n.courrielFacturation=$('#commande_facturation_courriel_first').val();n.courrielValidation=$('#commande_facturation_courriel_second').val();$('#ValNomFa').text(n.nomFacturation);$('#ValPreFa').text(n.prenomFacturation);$('#ValPaysFa').text(n.paysFacturation);$('#ValCourrielFa').text(n.courrielFacturation);$('#ValTotal').text($('#totalPanier').text());$('#recap').empty();$('#panierBillets').clone().appendTo($('#recap'));$('#step3').removeClass('stepActuOn');$('#step3').addClass('stepActuOff');$('#bloc_facturation').hide(1000,function(){$('#step4').removeClass('stepActuOff');$('#step4').addClass('stepActuOn');$('#bloc_validation').show(800)})}});$('#back2').click(function(){if(s===1){s=0;$('.blocUnBillet'+t).hide(800);t=0;$('#step2').removeClass('stepActuOn');$('#step2').addClass('stepActuOff');$('#bloc_billet').hide(1000,function(){$('#step1').removeClass('stepActuOff');$('#step1').addClass('stepActuOn');$('#bloc_choix').show(800)});$('#back').prop('disabled',!0)}});$('#back3').click(function(){if(s===2){s=1;t=0;$('#step3').removeClass('stepActuOn');$('#step3').addClass('stepActuOff');$('#bloc_facturation').hide(1000,function(){$('#step2').removeClass('stepActuOff');$('#step2').addClass('stepActuOn');if(g>1){$('#nextB').prop('disabled',!1);$('#next2').prop('disabled',!0)};$('#backB').prop('disabled',!0);$('#bloc_billet').show(800);$('.blocUnBillet0').show(800)})}});$('#back4').click(function(){if(s===3){s=2;$('#step4').removeClass('stepActuOn');$('#step4').addClass('stepActuOff');$('#bloc_validation').hide(1000,function(){$('#step3').removeClass('stepActuOff');$('#step3').addClass('stepActuOn');$('#bloc_facturation').show(800)})}});$('#nextB').click(function(e){k($('#commande_billets_'+t+'_nomBillet'),$('#commande_billets_'+t+'_prenomBillet'),$('#commande_billets_'+t+'_paysBillet'),$('#commande_billets_'+t+'_naissanceBillet'));if(u===1||h===1||b===1||c===1){return!1};P($('#commande_billets_'+t+'_naissanceBillet'));if(f===1){return!1};$('#nextB').prop('disabled',!0);$('#backB').prop('disabled',!0);$('.blocUnBillet'+t).fadeOut(500,function(){t+=1;$('#nextB').prop('disabled',!1);$('.blocUnBillet'+t).fadeIn(250);if(t>=(($('#commande_qte').val())-1)){$('#nextB').prop('disabled',!0);$('#backB').prop('disabled',!1);$('#next2').prop('disabled',!1)}
else{$('#nextB').prop('disabled',!1);$('#backB').prop('disabled',!1)}})});$('#backB').click(function(e){u=0;h=0;b=0;c=0;f=0;B=0;$('#backB').prop('disabled',!0);$('#nextB').prop('disabled',!0);if((t<$('#commande_qte').val())&&($('#commande_qte').val()>1)){$('#next2').prop('disabled',!0)};$('.blocUnBillet'+t).fadeOut(500,function(){t-=1;$('#backB').prop('disabled',!1);$('.blocUnBillet'+t).fadeIn(250);if(t<=0){$('#backB').prop('disabled',!0);$('#nextB').prop('disabled',!1)}
else{$('#nextB').prop('disabled',!1);$('#backB').prop('disabled',!1)}})});$('.dateReserv').datepicker({defaultDate:y,dateFormat:'dd/mm/yy',changeYear:!0,changeMonth:!0,yearRange:':+10',minDate:y,beforeShowDay:function(e){if((e.getDay()===2)||(e.getDay()===0)||((e.getDate()===1)&&(e.getMonth()===0))||((e.getDate()===14)&&(e.getMonth()===6))||((e.getDate()===15)&&(e.getMonth()===7))||((e.getDate()===1)&&(e.getMonth()===4))||((e.getDate()===1)&&(e.getMonth()===10))||((e.getDate()===25)&&(e.getMonth()===11))){return[!1,'']}
else{return[!0,'']}},onSelect:function(e,t){if(e!==t.lastVal){$(this).change()}}});$('.dateFacturation').datepicker({defaultDate:null,dateFormat:'dd/mm/yy',changeYear:!0,changeMonth:!0,yearRange:'-130:',maxDate:y,onSelect:function(e,t){if(e!==t.lastVal){$(this).change()}}});$('.dateReserv').change(function(){$('#dateVisite').text($('.dateReserv').val());$('#next1').prop('disabled',!0);if((E>=18)&&(x===$('.dateReserv').val())){$('#commande_demiJournee_0').attr('checked',!1).prop('disabled',!0);$('#commande_demiJournee_1').attr('checked',!1).prop('disabled',!0);if(e==='FR'){$('#dateVisite').text('Heure de visite dépassée pour cette date').css('color','red');$('#typeBillet').text('Aucun type de billet selectionné')}
else if(e==='EN'){$('#dateVisite').text('Hour of visit exceeded').css('color','red');$('#typeBillet').text('No ticket\'s type selected')};$('#next1').prop('disabled',!0)}
else if((E>=14)&&(x===$('.dateReserv').val())){$('#commande_demiJournee_0').attr('checked',!1).prop('disabled',!0);$('#commande_demiJournee_1').attr('checked',!1).prop('disabled',!1);if(e==='FR'){$('#typeBillet').text('Demi-journée')}
else if(e==='EN'){$('#typeBillet').text('Half-day')};$('#dateVisite').css('color','black')}
else{$('#commande_demiJournee_0').attr('checked',!1).prop('disabled',!1);$('#commande_demiJournee_1').attr('checked',!1).prop('disabled',!1);if(e==='FR'){$('#typeBillet').text('Aucun type de billet selectionné')}
else if(e==='EN'){$('#typeBillet').text('No ticket\'s type selected')};$('#dateVisite').css('color','black')}});$('#commande_demiJournee').change(function(){if($('#commande_qte').val()>0){$('#next1').prop('disabled',!1)};if($('#commande_demiJournee_0').is(':checked')){if(e==='FR'){$('#typeBillet').text('Journée')}
else if(e==='EN'){$('#typeBillet').text('Day')};$('#addBillet').prop('disabled',!1);$('#supBillet').prop('disabled',!1);$('#totalPanier').text('TOTAL : '+l+'€')}
else if($('#commande_demiJournee_1').is(':checked')){if(e==='FR'){$('#typeBillet').text('Demi-journée');$('#totalPanier').text('TOTAL (-50% demi-journée) : '+(l/2)+'€')}
else if(e==='EN'){$('#typeBillet').text('Half-day');$('#totalPanier').text('TOTAL (50% off for half-day) : '+(l/2)+'€')};$('#addBillet').prop('disabled',!1);$('#supBillet').prop('disabled',!1)}
else if($('#commande_demiJournee_0').is(':not:checked')&&$('#commande_demiJournee_1').is(':not:checked')){if(e==='FR'){$('#typeBillet').text('Aucun type de billet selectionné')}
else if(e==='EN'){$('#typeBillet').text('No ticket\'s type selected')};$('#addBillet').prop('disabled',!0);$('#supBillet').prop('disabled',!0);$('#subForm').prop('disabled',!0);$('#totalPanier').text('TOTAL : '+l+'€')}});$('#commande_qte').change(function(){$('#nbPersonne').text($('#commande_qte').val())});$(document).ready(function(){var s=$('div#commande_billets'),t=s.find(':input').length;$('#addBillet').click(function(e){if(t>=0&&t<9){n(s);$('.date').css('background-color','#FFF');$('#nbPersonne').text($('#commande_qte').val());$('#next1').prop('disabled',!1)};e.preventDefault();return!1});$('#supBillet').click(function(a){if(t>0&&t<10){o(s);$('#nbPersonne').text($('#commande_qte').val());if(t===0){$('#bloc_billet').hide();$('#bloc_facturation').hide();if(e==='FR'){$('#nbPersonne').text('Aucun billet dans le panier')}
else if(e==='EN'){$('#nbPersonne').text('Basket empty')};$('#next1').prop('disabled',!0)}};a.preventDefault();return!1});function n(a){if(e==='EN'){var i=z}
else if(e==='FR'){var i=q};var l=a.attr('data-prototype').replace(/__name__label__/g,i+(t+1)).replace(/__name__/g,t),s=$(l).addClass('well hideBillet blocUnBillet'+t);a.append(s);t++;$('#commande_qte').val(t);$('.dateBillets').datepicker({defaultDate:null,dateFormat:'dd/mm/yy',changeYear:!0,changeMonth:!0,yearRange:'-130:',maxDate:y,onSelect:function(e,t){if(e!==t.lastVal){$(this).change()}}});F($('.dateBillets'))};function o(){var s=$('#panierBillets').find('div').hasClass('commande_billets_'+(t-1));if(s===!0){for(i=0;i<a.length;i++){if(a[i].idBillet===$('div.commande_billets_'+(t-1)).attr('class')){l=l-a[i].prixTarif;a.splice(i,1);$('#icoPanier').text(a.length)}};$('div.commande_billets_'+(t-1)).remove();if($('#commande_demiJournee_1').is(':checked')){if(e==='FR'){$('#totalPanier').text('TOTAL (-50% demi-journée) : '+(l/2)+'€')}
else if(e==='EN'){$('#totalPanier').text('TOTAL (50% off for half-day) : '+(l/2)+'€')}}
else{$('#totalPanier').text('TOTAL : '+l+'€')}};$('div#commande_billets > div.form-group:last-of-type').remove();t--;$('#commande_qte').val(t)}});$('form[name="contact"] input[type=text]').on('change invalid',function(){var t=$(this).get(0);t.setCustomValidity('');if(!t.validity.valid){if(e==='FR'){t.setCustomValidity('Veuillez remplir ce champ')}
else if(e==='EN'){t.setCustomValidity('Please fill in the field')}}});$('form[name="contact"] textarea').on('change invalid',function(){var t=$(this).get(0);t.setCustomValidity('');if(!t.validity.valid){if(e==='FR'){t.setCustomValidity('Veuillez remplir ce champ')}
else if(e==='EN'){t.setCustomValidity('Please fill in the field')}}});$('form[name="contact"] input[type=email]').on('change invalid',function(){var t=$(this).get(0);t.setCustomValidity('');if(!t.validity.valid){if(e==='FR'){t.setCustomValidity('Format inexact : adresse@mail.com')}
else if(e==='EN'){t.setCustomValidity('Incorrect format : adresse@mail.com')}}});$('form[name="recherche"] input[type=email]').on('change invalid',function(){var t=$(this).get(0);t.setCustomValidity('');if(!t.validity.valid){if(e==='FR'){t.setCustomValidity('Format inexact : adresse@mail.com')}
else if(e==='EN'){t.setCustomValidity('Incorrect format : adresse@mail.com')}}})});