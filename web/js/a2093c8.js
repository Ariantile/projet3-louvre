;$(function(){function Ce(e,t,a,i){this.dateVisite=e;this.typeBillet=t;this.nbVisiteur=a;this.totalPrix=i};function D(e,t,a,i,l,s,n){this.nomBillet=e;this.prenomBillet=t;this.paysBillet=a;this.naissanceBillet=i;this.idBillet=l;this.nomTarif=s;this.prixTarif=n};function Ee(e,t,a,i){this.nomFacturation=e;this.prenomFacturation=t;this.paysFacturation=a;this.naissanceFacturation=i};var p=$('#dateConnexion').text(),u=p.split('/'),y=$.datepicker.parseDate('dd/mm/yy',p),F=parseInt($('#heureConnexion').text()),d,c,a=[],Pe=[],s,t=0,q=0,l=0,h,v,b,n,f,g,C,x,m,B,E,R=/^[0-3][0-9]\/[0-1][0-9]\/[1-2][901][0-9][0-9]$/,J=/^[a-zA-Z-'éíóúèìòùâêîôûëäïöüãñæçÉÍÓÚÈÌÒÙÂÊÎÔÛËÄÏÖÜÃÑÆÇ]+$/,M=/^[a-z0-9._-]+@[a-z0-9._-]{2,}\.[a-z]{2,10}$/,e=$('#locale').text(),L='Billet n°',T='<p class="messageErreur">Doit comporter entre 2 et 30 caractères alphabétiques.</p>',U='<p class="messageErreur">Veuillez indiquer votre pays de résidence.</p>',k='<p class="messageErreur">Date incorrecte, format : JJ/MM/AAAA</p>',I='<p class="messageErreur">Entrée gratuite pour les moins de 4 ans.</p>',z='<p class="messageErreur">Tarif réduit non applicable.</p>',Y='<p class="messageErreur">Adresse courriel invalide, format : adresse@mail.com</p>',j='<p class="messageErreur">Le champ de confirmation doit être identique au champ courriel.</p>',H='Ticket n°',P='<p class="messageErreur">From 2 to 30 alphabetic characters only.</p>',S='<p class="messageErreur">Please indicate your country of residence.</p>',V='<p class="messageErreur">Invalid date, format : DD/MM/YYYY</p>',Z='<p class="messageErreur">Free access for child aged under 4.</p>',ee='<p class="messageErreur">Reduced rate not applicable.</p>',te='<p class="messageErreur">Invalid email addresse, format : addresse@mail.com</p>',ae='<p class="messageErreur">Both email fields must be identical.</p>',ie='Enfant de moins de 4 ans : Entrée gratuite',le='Tarif réduit unique',se='Tarif enfant, de 4 à 11 ans',ne='Tarif normal, de 12 à 59 ans',re='Tarif senior, 60 ans et plus',oe='Date de naissance invalide',ce='Child aged under 4 : Free access',de='Unique reduced rate',fe='Child rate, from 4 to 11 years old',me='Normal rate, from 12 to 59 years old',pe='Senior rate, from 60 years old',ue='Invalid date of birth',he='<p class="messageErreur">Heure de visite dépassée pour ce jour</p>',ve='<p class="messageErreur">Billet journée indisponible après 14h</p>',be='<p class="messageErreur">Veuillez selectionner un type de billet</p>',ge='<p class="messageErreur">Nombre de billet par commande : entre 1 et 9</p>',xe='<p class="messageErreur">Visit time passed for this day</p>',Be='<p class="messageErreur">Day ticket unavailable after 14.00</p>',ye='<p class="messageErreur">Please select a ticket type</p>',Fe='<p class="messageErreur">Number of ticket : between 1 and 9</p>';function A(e){e.keydown(function(e){if(e.keyCode!==193&&e.keyCode!==111){if(e.keyCode!==8){if($(this).val().length===2){$(this).val($(this).val()+'/')}
else if($(this).val().length===5){$(this).val($(this).val()+'/')}}
else{var t=$(this).val();if($(this).val().length===5){$(this).val(t.substring(0,4))}
else if($(this).val().length===2){$(this).val(t.substring(0,1))}}}
else{var t=$(this).val(),a=$(this).val().length;$(this).val(t.substring(0,a-1))}})};function r(e,t){e.addClass('champVide');if(!e.next().hasClass('messageErreur')){e.parent().append(t)}};function o(e){e.removeClass('champVide');if(e.next().hasClass('messageErreur')){e.next().remove()}};function N(t){var c=$('#panierBillets').find('div').hasClass(t.idBillet);if(c===!0){$('div.'+t.idBillet+' > p.nomPanier').text(t.nomBillet);$('div.'+t.idBillet+' > p.tarifPanier').text(t.nomTarif+' : '+t.prixTarif+'€')}
else{var i=$('<div></div>'),n=$('<p class="nomPanier"></p>'),r=$('<p class="prenomPanier"></p>'),o=$('<p class="tarifPanier"></p>');i.addClass(t.idBillet);n.text(t.nomBillet);r.text(t.prenomBillet);o.text(t.nomTarif+' : '+t.prixTarif+'€');i.append(n);i.append(r);i.append(o);$('#panierBillets').append(i);$('#icoPanier').text(a.length)};l=0;for(var s=0;s<a.length;s++){l+=parseFloat(a[s].prixTarif)};if($('#commande_demiJournee_1').is(':checked')){if(e==='FR'){$('#totalPanier').text('TOTAL (-50% demi-journée) : '+(l/2)+'€')}
else if(e==='EN'){$('#totalPanier').text('TOTAL (50% off for half-day) : '+(l/2)+'€')}}
else{$('#totalPanier').text('TOTAL : '+l+'€')}};function Re(e,t,l,s,r,o,c){var d=0;if(a.length===0){var n=new D(e,t,l,s,r,o,c);a.push(n);N(n)}
else{for(var i=0;i<a.length;i++){if(a[i].idBillet===r){d=1;a[i].nomBillet=e;a[i].prenomBillet=t;a[i].paysBillet=l;a[i].naissanceBillet=s;a[i].nomTarif=o;a[i].prixTarif=c;N(a[i])}};if(d===0){var n=new D(e,t,l,s,r,o,c);a.push(n);N(n)}}};function ke(e){var t=e.split('/');if((t[2]>u[2])||(t[2]===u[2]&&t[1]>u[1])||(t[2]===u[2]&&t[1]===u[1]&&t[0]>u[0])){m=1}
else if(t[0]>31||t[0]===0){m=1}
else if((t[0]>30)&&(t[1]==='04'||t[1]==='06'||t[1]==='09'||t[1]==='11')){m=1}
else if(t[1]==='02'&&t[0]>28){if(t[0]==='29'&&(t[2]%400===0||(t[2]%100!==0&&t[2]%4===0))){m=0}
else{m=1}}
else{m=0}};function Ve(t){var a;if(t.val().length<10||t.val()===''||t.val()===null||!R.test(t.val())){if(e==='FR'){a=k};if(e==='EN'){a=V};r(t,a);n=1}
else{ke(t.val());if(m===1){if(e==='FR'){a=k};if(e==='EN'){a=V};r(t,a);n=1}
else if(t.hasClass('champVide')){o(t);n=0}}};function Ae(){if($('#commande_billets_'+t+'_tarifReduit').is(':checked')){B=1}
else{B=0;f=0;if($('#commande_billets_'+t+'_tarifReduit').hasClass('champVide')){o($('#commande_billets_'+t+'_tarifReduit'))}}};function O(t,a,i,l){var s,n;if(t.val().length<=1||t.val().length>30||t.val()===''||!J.test(t.val())){if(e==='FR'){s=T};if(e==='EN'){s=P};r(t,s);h=1}
else{if(t.hasClass('champVide')){o(t);h=0}};if(a.val().length<=1||t.val().length>30||a.val()===''){if(e==='FR'){s=T};if(e==='EN'){s=P};r(a,s);v=1}
else{if(a.hasClass('champVide')){o(a);v=0}};if(i.val()===null||i.val()===''){if(e==='FR'){n=U};if(e==='EN'){n=S};r(i,n);b=1}
else{if(i.hasClass('champVide')){o(i);b=0}};Ve(l)};function Ne(t){var a;if(!M.test(t.val())){if(e==='FR'){a=Y};if(e==='EN'){a=te};r(t,a);g=1}
else{if(t.hasClass('champVide')){o(t);g=0}}};function Oe(t,a){var i;if(t.val()!=a.val()){if(e==='FR'){i=j};if(e==='EN'){i=ae};r(a,i);g=1}
else{if(a.hasClass('champVide')){o(a);g=0}}};function Te(t,a,l,s){var d,i,c;if(t.val().length<10||t.val()===''||t.val()===null||!R.test(t.val())){if(e==='FR'){i=k};if(e==='EN'){i=V};if(t.hasClass('champVide')){o(t)};r(t,i);n=1}
else if((F>=18)&&(p===$('.dateReserv').val())){if(e==='FR'){i=he};if(e==='EN'){i=xe};if(t.hasClass('champVide')){o(t)};r(t,i);n=1}
else if((F>=14)&&(p===$('.dateReserv').val())&&(l.is(':checked'))){if(e==='FR'){i=ve};if(e==='EN'){i=Be};if(t.hasClass('champVide')){o(t)};r(t,i);n=1}
else{if(t.hasClass('champVide')){o(t);n=0};n=0};if((l.is(':not(:checked)'))&&(s.is(':not(:checked)'))){x=1;if(e==='FR'){d=be}
else if(e==='EN'){d=ye};if(!$('#commande_demiJournee').children().last().hasClass('messageErreur')){$('#commande_demiJournee').append(d)}}
else{console.log(x);if($('#commande_demiJournee').children().last().hasClass('messageErreur')){$('#commande_demiJournee').children().last().remove();x=0};x=0};if(a.val()<=0||a.val()>9||a.val()===null){if(e==='FR'){c=ge}
else if(e==='EN'){c=Fe};r(a,c);C=1;console.log(C)}
else{o(a,c);C=0}};function w(a){var s=$('.dateReserv').val().split('/'),n=$(a).val().split('/'),u=s[2]-n[2],i,c,l,d;Ae();if(R.test($('.dateReserv').val())){if((n[1]<s[1])||((n[1]===s[1])&&(n[0]<s[0]))){i=u-1}
else if((n[1]>s[1])||((n[1]===s[1])&&(n[0]>s[0]))){i=u}
else if((n[1]===s[1])&&(n[0]===s[0])){i=u}}
else{i=!1};if(i<4){c=0;if(e==='FR'){l=ie}
else if(e==='EN'){l=ce}}
else if(B===1&&i>=12){c=10;if(e==='FR'){l=le}
else if(e==='EN'){l=de};d='reduit';f=0;if($('#commande_billets_'+t+'_tarifReduit').hasClass('champVide')){o($('#commande_billets_'+t+'_tarifReduit'))}}
else if(i>=4&&i<12){c=8;if(e==='FR'){l=se}
else if(e==='EN'){l=fe};d='enfant'}
else if(i>=12&&i<60){c=16;if(e==='FR'){l=ne}
else if(e==='EN'){l=me};d='normal'}
else if(i>=60){c=12;if(e==='FR'){l=re}
else if(e==='EN'){l=pe};d='senior'}
else{c=0;if(e==='FR'){l=oe}
else if(e==='EN'){l=ue};d='invalide'};if(B===1&&i<12){var p;f=1;if(e==='FR'){p=z}
else if(e==='EN'){p=ee};r($('#commande_billets_'+t+'_tarifReduit'),p);return!1}
else if(i<4||c===0){var m;f=1;if(e==='FR'){m=I}
else if(e==='EN'){m=Z};r($('#commande_billets_'+t+'_naissanceBillet'),m);return!1};Re($('#commande_billets_'+t+'_nomBillet').val(),$('#commande_billets_'+t+'_prenomBillet').val(),$('#commande_billets_'+t+'_paysBillet').val(),$('#commande_billets_'+t+'_naissanceBillet').val(),$('#commande_billets_'+t+'_nomBillet').parent().parent().attr('id'),l,c);$('#commande_billets_'+t+'_prixBillet').val(c);$('#commande_billets_'+t+'_tarifBillet').val(d)};$('#totalPanier').val(0);A($('.dateReserv'));A($('.dateFacturation'));$('#tabs').tabs();$('#btPanier').click(function(){if($('#panier').is(':visible')){$('#panier').fadeOut(250)}
else{$('#panier').fadeIn(250)}});$(window).scroll(function(){$('#panier').fadeOut(50)});$('#next0').click(function(){s=0;$('#secuHorraire').hide(1000,function(){$('#bloc_choix').show(800)})});$('#next1').click(function(){if((s===0)&&(q===0)){Te($('#commande_dateReservation'),$('#commande_qte'),$('#commande_demiJournee_0'),$('#commande_demiJournee_1'));if(n===1||C===1||x===1){return!1};s=1;t=0;d=new Ce();d.dateVisite=$('.dateReserv').val();d.typeBillet=$('#typeBillet').text();d.nbVisiteur=$('#commande_qte').val();d.totalPrix=0;E=$('#commande_qte').val();if(E>1){$('#next2').prop('disabled',!0)}
else{$('#next2').prop('disabled',!1)};$('#step1').removeClass('stepActuOn');$('#step1').addClass('stepActuOff');$('#bloc_choix').hide(1000,function(){$('#step2').removeClass('stepActuOff');$('#step2').addClass('stepActuOn');$('#bloc_billet').show(800);$('.blocUnBillet0').show(800);$('#backB').prop('disabled',!0);if(d.nbVisiteur<=1){$('#nextB').prop('disabled',!0)}
else if(d.nbVisiteur>1){$('#nextB').prop('disabled',!1)}})}});$('#next2').click(function(){if(s===1){O($('#commande_billets_'+t+'_nomBillet'),$('#commande_billets_'+t+'_prenomBillet'),$('#commande_billets_'+t+'_paysBillet'),$('#commande_billets_'+t+'_naissanceBillet'));if(h===1||v===1||b===1||n===1){return!1};w($('#commande_billets_'+t+'_naissanceBillet'));if(f===1){return!1};s=2;$('.blocUnBillet'+t).hide(800);$('#step2').removeClass('stepActuOn');$('#step2').addClass('stepActuOff');$('#bloc_billet').hide(1000,function(){$('#step3').removeClass('stepActuOff');$('#step3').addClass('stepActuOn');$('#bloc_facturation').show(800)})}});$('#next3').click(function(){if(s===2){O($('#commande_facturation_nomFacture'),$('#commande_facturation_prenomFacture'),$('#commande_facturation_pays'),$('#commande_facturation_naissanceFacture'));Ne($('#commande_facturation_courriel_first'));Oe($('#commande_facturation_courriel_first'),$('#commande_facturation_courriel_second'));if(h===1||v===1||b===1||n===1||g===1){return!1};s=3;c=new Ee();c.nomFacturation=$('#commande_facturation_nomFacture').val();c.prenomFacturation=$('#commande_facturation_prenomFacture').val();c.paysFacturation=$('#commande_facturation_pays option:selected').text();c.naissanceFacturation=$('#commande_facturation_naissanceFacture').val();c.courrielFacturation=$('#commande_facturation_courriel_first').val();c.courrielValidation=$('#commande_facturation_courriel_second').val();$('#ValNomFa').text(c.nomFacturation);$('#ValPreFa').text(c.prenomFacturation);$('#ValPaysFa').text(c.paysFacturation);$('#ValCourrielFa').text(c.courrielFacturation);$('#ValTotal').text($('#totalPanier').text());$('#recap').empty();$('#panierBillets').clone().appendTo($('#recap'));$('#step3').removeClass('stepActuOn');$('#step3').addClass('stepActuOff');$('#bloc_facturation').hide(1000,function(){$('#step4').removeClass('stepActuOff');$('#step4').addClass('stepActuOn');$('#bloc_validation').show(800)})}});$('#back2').click(function(){if(s===1){s=0;$('.blocUnBillet'+t).hide(800);t=0;$('#step2').removeClass('stepActuOn');$('#step2').addClass('stepActuOff');$('#bloc_billet').hide(1000,function(){$('#step1').removeClass('stepActuOff');$('#step1').addClass('stepActuOn');$('#bloc_choix').show(800)});$('#back').prop('disabled',!0)}});$('#back3').click(function(){if(s===2){s=1;t=0;$('#step3').removeClass('stepActuOn');$('#step3').addClass('stepActuOff');$('#bloc_facturation').hide(1000,function(){$('#step2').removeClass('stepActuOff');$('#step2').addClass('stepActuOn');if(E>1){$('#nextB').prop('disabled',!1);$('#next2').prop('disabled',!0)};$('#backB').prop('disabled',!0);$('#bloc_billet').show(800);$('.blocUnBillet0').show(800)})}});$('#back4').click(function(){if(s===3){s=2;$('#step4').removeClass('stepActuOn');$('#step4').addClass('stepActuOff');$('#bloc_validation').hide(1000,function(){$('#step3').removeClass('stepActuOff');$('#step3').addClass('stepActuOn');$('#bloc_facturation').show(800)})}});$('#nextB').click(function(e){O($('#commande_billets_'+t+'_nomBillet'),$('#commande_billets_'+t+'_prenomBillet'),$('#commande_billets_'+t+'_paysBillet'),$('#commande_billets_'+t+'_naissanceBillet'));if(h===1||v===1||b===1||n===1){return!1};w($('#commande_billets_'+t+'_naissanceBillet'));if(f===1){return!1};$('#nextB').prop('disabled',!0);$('#backB').prop('disabled',!0);$('.blocUnBillet'+t).fadeOut(500,function(){t+=1;$('#nextB').prop('disabled',!1);$('.blocUnBillet'+t).fadeIn(250);if(t>=(($('#commande_qte').val())-1)){$('#nextB').prop('disabled',!0);$('#backB').prop('disabled',!1);$('#next2').prop('disabled',!1)}
else{$('#nextB').prop('disabled',!1);$('#backB').prop('disabled',!1)}})});$('#backB').click(function(e){h=0;v=0;b=0;n=0;f=0;B=0;$('#backB').prop('disabled',!0);$('#nextB').prop('disabled',!0);if((t<$('#commande_qte').val())&&($('#commande_qte').val()>1)){$('#next2').prop('disabled',!0)};$('.blocUnBillet'+t).fadeOut(500,function(){t-=1;$('#backB').prop('disabled',!1);$('.blocUnBillet'+t).fadeIn(250);if(t<=0){$('#backB').prop('disabled',!0);$('#nextB').prop('disabled',!1)}
else{$('#nextB').prop('disabled',!1);$('#backB').prop('disabled',!1)}})});$('.dateReserv').datepicker({defaultDate:y,dateFormat:'dd/mm/yy',changeYear:!0,changeMonth:!0,yearRange:':+10',minDate:y,beforeShowDay:function(e){if((e.getDay()===2)||(e.getDay()===0)||((e.getDate()===1)&&(e.getMonth()===0))||((e.getDate()===14)&&(e.getMonth()===6))||((e.getDate()===15)&&(e.getMonth()===7))||((e.getDate()===1)&&(e.getMonth()===4))||((e.getDate()===1)&&(e.getMonth()===10))||((e.getDate()===25)&&(e.getMonth()===11))){return[!1,'']}
else{return[!0,'']}},onSelect:function(e,t){if(e!==t.lastVal){$(this).change()}}});$('.dateFacturation').datepicker({defaultDate:null,dateFormat:'dd/mm/yy',changeYear:!0,changeMonth:!0,yearRange:'-130:',maxDate:y,onSelect:function(e,t){if(e!==t.lastVal){$(this).change()}}});$('.dateReserv').change(function(){$('#dateVisite').text($('.dateReserv').val());if((F>=18)&&(p===$('.dateReserv').val())){if(e==='FR'){$('#dateVisite').text('Heure de visite dépassée pour cette date').css('color','red')}
else if(e==='EN'){$('#dateVisite').text('Hour of visit exceeded').css('color','red')}}
else if((F>=14)&&(p===$('.dateReserv').val())){if(e==='FR'){$('#typeBillet').text('Demi-journée')}
else if(e==='EN'){$('#typeBillet').text('Half-day')};$('#dateVisite').css('color','black')}
else{$('#dateVisite').css('color','black')}});$('#commande_demiJournee').change(function(){if($('#commande_qte').val()>0){$('#next1').prop('disabled',!1)};if($('#commande_demiJournee_0').is(':checked')){if(e==='FR'){$('#typeBillet').text('Journée')}
else if(e==='EN'){$('#typeBillet').text('Day')};$('#totalPanier').text('TOTAL : '+l+'€')}
else if($('#commande_demiJournee_1').is(':checked')){if(e==='FR'){$('#typeBillet').text('Demi-journée');$('#totalPanier').text('TOTAL (-50% demi-journée) : '+(l/2)+'€')}
else if(e==='EN'){$('#typeBillet').text('Half-day');$('#totalPanier').text('TOTAL (50% off for half-day) : '+(l/2)+'€')}}
else if($('#commande_demiJournee_0').is(':not:checked')&&$('#commande_demiJournee_1').is(':not:checked')){if(e==='FR'){$('#typeBillet').text('Aucun type de billet selectionné')}
else if(e==='EN'){$('#typeBillet').text('No ticket\'s type selected')};$('#totalPanier').text('TOTAL : '+l+'€')}});$('#commande_qte').change(function(){$('#nbPersonne').text($('#commande_qte').val())});$(document).ready(function(){var s=$('div#commande_billets'),t=s.find(':input').length;$('#addBillet').click(function(e){if(t>=0&&t<9){n(s);$('.date').css('background-color','#FFF');$('#nbPersonne').text($('#commande_qte').val());$('#next1').prop('disabled',!1)};e.preventDefault();return!1});$('#supBillet').click(function(a){if(t>0&&t<10){r(s);$('#nbPersonne').text($('#commande_qte').val());if(t===0){$('#bloc_billet').hide();$('#bloc_facturation').hide();if(e==='FR'){$('#nbPersonne').text('Aucun billet dans le panier')}
else if(e==='EN'){$('#nbPersonne').text('Basket empty')};$('#next1').prop('disabled',!0)}};a.preventDefault();return!1});function n(a){if(e==='EN'){var i=H}
else if(e==='FR'){var i=L};var l=a.attr('data-prototype').replace(/__name__label__/g,i+(t+1)).replace(/__name__/g,t),s=$(l).addClass('well hideBillet blocUnBillet'+t);a.append(s);t++;$('#commande_qte').val(t);$('.dateBillets').datepicker({defaultDate:null,dateFormat:'dd/mm/yy',changeYear:!0,changeMonth:!0,yearRange:'-130:',maxDate:y,onSelect:function(e,t){if(e!==t.lastVal){$(this).change()}}});A($('.dateBillets'))};function r(){var s=$('#panierBillets').find('div').hasClass('commande_billets_'+(t-1));if(s===!0){for(i=0;i<a.length;i++){if(a[i].idBillet===$('div.commande_billets_'+(t-1)).attr('class')){l=l-a[i].prixTarif;a.splice(i,1);$('#icoPanier').text(a.length)}};$('div.commande_billets_'+(t-1)).remove();if($('#commande_demiJournee_1').is(':checked')){if(e==='FR'){$('#totalPanier').text('TOTAL (-50% demi-journée) : '+(l/2)+'€')}
else if(e==='EN'){$('#totalPanier').text('TOTAL (50% off for half-day) : '+(l/2)+'€')}}
else{$('#totalPanier').text('TOTAL : '+l+'€')}};$('div#commande_billets > div.form-group:last-of-type').remove();t--;$('#commande_qte').val(t)}});$('form[name="contact"] input[type=text]').on('change invalid',function(){var t=$(this).get(0);t.setCustomValidity('');if(!t.validity.valid){if(e==='FR'){t.setCustomValidity('Veuillez remplir ce champ')}
else if(e==='EN'){t.setCustomValidity('Please fill in the field')}}});$('form[name="contact"] textarea').on('change invalid',function(){var t=$(this).get(0);t.setCustomValidity('');if(!t.validity.valid){if(e==='FR'){t.setCustomValidity('Veuillez remplir ce champ')}
else if(e==='EN'){t.setCustomValidity('Please fill in the field')}}});$('form[name="contact"] input[type=email]').on('change invalid',function(){var t=$(this).get(0);t.setCustomValidity('');if(!t.validity.valid){if(e==='FR'){t.setCustomValidity('Format inexact : adresse@mail.com')}
else if(e==='EN'){t.setCustomValidity('Incorrect format : adresse@mail.com')}}});$('form[name="recherche"] input[type=email]').on('change invalid',function(){var t=$(this).get(0);t.setCustomValidity('');if(!t.validity.valid){if(e==='FR'){t.setCustomValidity('Format inexact : adresse@mail.com')}
else if(e==='EN'){t.setCustomValidity('Incorrect format : adresse@mail.com')}}})});